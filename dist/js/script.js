let pokemonRepository=function(){let e=[],t=0,n=`https://pokeapi.co/api/v2/pokemon/?offset=${t}&limit=30`;function i(){return e}function o(t){var n;let i,o,a=(i=Object.keys(n=t),o=!1,i.forEach(function(e){if("name"!==e&&"type"!==e&&"species"!==e&&"height"!==e)return!1;o=!0}),o);"object"==typeof t&&a?e.push(t):console.log("Pokemon Type is not an object or contains incorrect keys and is invalid")}function a(e){let t=document.querySelector(".pokemon-list"),n=document.createElement("li");n.classList.add("list__item","list-group-item");let i=document.createElement("button");i.classList.add("pokemon-tile","btn","btn-primary"),i.setAttribute("data-toggle","modal"),i.setAttribute("data-target","#pokemonModal");let o=document.createElement("div");o.innerText=e.name;let a=document.createElement("img");a.classList.add("pokemon-list--image"),d(e).then(function(){a.src=e.imageUrl,a.alt=`Thumbnail image of ${e.name}`}),function e(t,n){t.addEventListener("click",function(){var e;let t,i,o,a,r,s,l;e=n,t=document.querySelector(".modal-body"),i=document.querySelector(".modal-title"),i.innerHTML="",t.innerHTML="",i.classList.add("pokemon-title--modal"),o=document.createElement("img"),o.classList.add("pokemon-image"),a=document.createElement("h2"),a.classList.add("height-title"),r=document.createElement("p"),s=document.createElement("h2"),s.classList.add("types-title"),l=document.createElement("ul"),l.classList.add("list-group"),c(e).then(function(){i.innerText=e.name,o.src=e.imageUrl,o.alt=`Image of ${e.name}`,a.innerText="Height",e.height<=1?r.innerText=`${e.height} Decimeter`:r.innerText=`${e.height} Decimeters`,s.innerText="Types",e.types.forEach(function(e){let t=document.createElement("li");t.classList.add("list-group-item","types-list-item"),t.innerText=e.type.name,l.appendChild(t)}),t.appendChild(o),t.appendChild(a),t.appendChild(r),t.appendChild(s),t.appendChild(l)})})}(i,e),i.appendChild(o),i.appendChild(a),n.appendChild(i),t.appendChild(n)}let r=async(i,a)=>(showLoadingMessage(),void 0===i?(t=150,n="https://pokeapi.co/api/v2/pokemon/?limit=150"):n=`https://pokeapi.co/api/v2/pokemon/?offset=${i}&limit=${a}`,await fetch(n).then(function(e){return e.json()}).then(function(t){t.results.forEach(function(t){if(void 0===e.find(e=>e.name===t.name)){let n={name:t.name,detailsUrl:t.url};o(n),d(n)}setTimeout(function(){hideLoadingMessage()},500)})}).catch(function(e){console.error(e),setTimeout(function(){hideLoadingMessage()},500)})),s=(e,t,n)=>e+t<n+1,l=async(e,t)=>{e<150&&showLoadingMessage(),console.log(e,t);try{e?s(e,t,150)&&(await r(e,t),printArrayDetails(pokemonRepository.getAll())):await r()}catch(n){console.log(n.message),setTimeout(function(){hideLoadingMessage()},500)}finally{setTimeout(function(){hideLoadingMessage()},500)}};function c(e){return showLoadingMessage(),fetch(e.detailsUrl).then(function(e){return e.json()}).then(function(t){e.imageUrl=t.sprites.other.dream_world.front_default,e.height=t.height,e.types=t.types;let n="";e.types.forEach(function(e){n=`${n} ${e.type.name}`}),setTimeout(function(){hideLoadingMessage()},500)}).catch(function(e){console.error(e),setTimeout(function(){hideLoadingMessage()},500)})}function d(e){return fetch(e.detailsUrl).then(function(e){return e.json()}).then(function(t){e.imageUrl=t.sprites.other.dream_world.front_default,setTimeout(function(){hideLoadingMessage()},1e3),e.types=t.types;let n="";e.types.forEach(function(e){n=`${n} ${e.type.name} `}),e.typesStr=n}).catch(function(e){console.error(e),setTimeout(function(){hideLoadingMessage()},1e3)})}return window.addEventListener("scroll",()=>{let{scrollTop:e,scrollHeight:n,clientHeight:i}=document.documentElement;e+i>=n-5&&s(t,30,150)&&l(t+=30,30)},{passive:!0}),r(t,30).then(function(){e.forEach(function(e){a(e)})}),{getAll:i,add:o,loadList:r,loadDetails:c,addListItem:a,loadPokemon:l}}();function printArrayDetails(e){document.querySelector(".pokemon-list").innerHTML="",e.forEach(function(e){pokemonRepository.addListItem(e)})}function filterPokemonList(e,t){pokemonRepository.loadPokemon(),setTimeout(()=>{if(""===e)showLoadingMessage(),setTimeout(()=>{hideLoadingMessage()},500),printArrayDetails(pokemonRepository.getAll());else{let n=pokemonRepository.getAll().filter(function(n){let i="";"name"===t&&(i=n.name.toLowerCase()),"pokemonType"===t&&(i=n.typesStr.toLowerCase());let o=e.toLowerCase();return i.includes(o)});if(0===n.length){let i=document.querySelector(".pokemon-list");i.innerHTML="";let o=document.createElement("li");o.classList.add("list__item","no-results"),o.innerText="No Search Results Found",i.appendChild(o)}else printArrayDetails(n)}},500)}let searchButton=document.querySelector(".filter");searchButton.addEventListener("click",function(){filterPokemonList(document.querySelector(".search-term").value,"name")});let clearButton=document.querySelector(".clear-filter");clearButton.addEventListener("click",function(){filterPokemonList("")});let typeDropdown=document.getElementById("pokemon-type__dropdown"),pokemonTypes=["Normal","Fire","Water","Grass","Electric","Ice","Fighting","Poison","Ground","Flying","Psychic","Bug","Rock","Ghost","Dragon","Steel","Fairy",],dropdownToggle=document.querySelector(".dropdown-toggle");function showLoadingMessage(){let e=document.querySelector(".waiting-screen");e.classList.remove("fadeout"),e.classList.add("is-visible")}function hideLoadingMessage(){let e=document.querySelector(".waiting-screen");e.classList.add("fadeout"),setTimeout(function(){e.classList.remove("is-visible")},300)}dropdownToggle.addEventListener("click",function(){let e=dropdownToggle.offsetWidth;document.querySelector("#pokemon-type__dropdown").setAttribute("style",`width: ${e}px`)}),pokemonTypes.forEach(function(e){let t=document.createElement("a");t.classList.add("dropdown-item",e),t.setAttribute("href","#"),t.innerText=e,t.addEventListener("click",function(){filterPokemonList(e,"pokemonType");let t=document.querySelector(`.${e}`),n=document.querySelector(".dropdown-item__active");n&&n.classList.remove("dropdown-item__active"),t.classList.add("dropdown-item__active")}),typeDropdown.appendChild(t)});